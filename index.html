<!DOCTYPE html>
<html>
  <head>
    <title>Canvas Disc</title>
    <link rel="stylesheet" href="/stylesheets/main.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="/stylesheets/results.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="/stylesheets/track_display.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="/stylesheets/search.css" type="text/css" media="screen" charset="utf-8">

    <script id='search-results-template' type='text/mustache'>
      <ul>
        {{#tracks}}
          <li data-track-id="{{id}}">
            <img src="{{artworkUrl}}"></img>
            <h3>{{title}}</h3>
            <h4>{{artistName}}</h4>
          </li>
        {{/tracks}}
        {{^tracks}}
          <h2>No tracks found.</h2>
        {{/tracks}}
      </ul>
    </script>

    <script id='track-display-template' type='text/mustache'>
      <div>
        <h2>{{title}}</h2>
        <h3>{{artistName}}</h3>
      </div>
    </script>

  </head>
  <body>
    <div id="wrap">
      <header>
        <form id="search">
          <input id="search-input" type="text" placeholder="Search SoundCloud"></input>
          <input type="submit" value="Go">
        </form>
        <h1>Canvas Disc</h1>
      </header>

      <section id="search-results-container"></section>

      <section id="canvas-container" class="paused">
        <div id="play">
          <h2>Search for a track.</h2>
        </div>
        <canvas id="circle" width="1024" height="1024"></canvas>
      </section>

      <section class="audio-container">
        <audio id="audio"
               controls="true"
               preload
               autobuffer>
        </audio>
      </section>

      <a id="download" download>Download</a>
    </div>

    <footer>
      
    </footer>
    <!-- scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="http://connect.soundcloud.com/2/latest.min.js" type="text/javascript"></script>

    <script src="/javascripts/supplement-0.1.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/dsp.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/audio.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/canvas.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/deferred.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/track.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/search.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/track_display.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/mustache.js" type="text/javascript" charset="utf-8"></script>
    <script src="/javascripts/poirot.js" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript" charset="utf-8">

      var setupDownloadLink = function () {
        var link = document.getElementById('download')
        link.href = canvas.toPng()
      }

      audio.init()
      canvas.init()

      audio.onSample(function (sample, delta) {
        canvas.rotate((delta / audio.duration()) * (Math.PI * 2))
        canvas.draw(sample)
      })

      search.init()

      search.onTrackSelected(function (track) {
        audio.loadTrack(track)
        trackDisplay.loadTrack(track)
      })
    </script>
  </body>
</html>